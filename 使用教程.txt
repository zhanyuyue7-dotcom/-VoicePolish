VoicePolish 使用教程 —— 语音输入自动润色工具
================================================

这是一个 Windows 工具，按快捷键就能用语音输入文字，AI 会自动帮你把口语化的内容整理成通顺的书面语，然后粘贴到你正在打字的地方。整个过程不需要你手动打一个字。

这篇教程会从零开始，一步一步教你把环境搭好、把工具跑起来。即使你从来没接触过编程，跟着做就行。


第一步：安装 Python
================================================

VoicePolish 是用 Python 写的，所以你的电脑上需要先装 Python。

1. 打开浏览器，访问 Python 官网下载页面：
   https://www.python.org/downloads/

2. 点页面上最大的那个黄色按钮「Download Python 3.x.x」，下载安装包。

3. 双击运行下载好的安装包。注意，安装界面最下面有一个勾选框：
   「Add Python to PATH」—— 这个一定要勾上！！！
   勾上之后再点「Install Now」。

4. 等它装完，点 Close 关闭。

5. 验证是否安装成功：
   - 按键盘上的 Win 键（就是那个 Windows 图标的键），输入 cmd，回车打开命令提示符
   - 在黑色窗口里输入：python --version
   - 如果显示类似 Python 3.12.x 这样的版本号，说明安装成功
   - 如果提示「不是内部或外部命令」，说明安装时没有勾选 Add to PATH，需要卸载重装，这次记得勾上


第二步：下载项目文件
================================================

你需要拿到以下这些文件，放在同一个文件夹里：

voice_polish/
  ├── voice_polish.py      （主程序）
  ├── config.json           （API 配置文件）
  └── requirements.txt      （依赖清单）

如果是从 GitHub 下载的，点页面上绿色的「Code」按钮，选「Download ZIP」，下载后解压到你想放的位置就行。比如放在桌面上也可以，放在 D 盘某个文件夹里也可以，随你。

记住这个文件夹的位置，后面要用。


第三步：获取 AI 接口的 API Key
================================================

这个工具需要调用 AI 接口来润色文字。你需要自己注册一个 API 账号并获取 Key。

目前项目默认使用的是字节跳动的豆包大模型（Doubao），你也可以换成其他兼容 OpenAI 接口格式的服务（比如 DeepSeek、OpenAI 官方、智谱等）。

以豆包为例：

1. 打开火山引擎控制台：https://console.volcengine.com/ark
2. 注册/登录账号
3. 在左侧菜单找到「模型推理」或「API Key 管理」
4. 创建一个 API Key，复制保存好
5. 记下你要用的模型名称（比如 doubao-seed-1-8-251228）

拿到 Key 之后，用记事本打开项目文件夹里的 config.json，改成你自己的信息：

{
  "api_base": "https://ark.cn-beijing.volces.com/api/v3",
  "api_key": "在这里粘贴你自己的API Key",
  "model": "在这里填你要用的模型名称"
}

保存关闭。

如果你用的是其他 AI 服务，把 api_base 换成对应的地址就行：
- DeepSeek：api_base 填 https://api.deepseek.com/v1
- OpenAI 官方：api_base 填 https://api.openai.com/v1
- 智谱 AI：api_base 填 https://open.bigmodel.cn/api/paas/v4

不管用哪家，格式都是一样的，改 config.json 里的三个值就行。


第四步：安装依赖包
================================================

1. 打开命令提示符（Win 键 → 输入 cmd → 回车）

2. 用 cd 命令进入你的项目文件夹。比如你的文件夹在 D:\voice_polish，就输入：
   cd /d D:\voice_polish

   如果在桌面上，就输入：
   cd %USERPROFILE%\Desktop\voice_polish

3. 输入以下命令安装所有依赖：
   pip install -r requirements.txt

4. 等它跑完，看到 Successfully installed 就说明装好了。

   如果报错说 pip 不是命令，试试用：
   python -m pip install -r requirements.txt

   如果下载很慢，可以用国内镜像加速：
   pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple


第五步：确认 Windows 语音输入可用
================================================

这个工具依赖 Windows 自带的语音输入功能（就是 Win+H 快捷键触发的那个）。

1. 打开记事本，随便点一下让光标在里面
2. 按键盘上的 Win+H（同时按 Windows 键和 H 键）
3. 应该会弹出一个小的麦克风浮窗
4. 对着麦克风说几句话，看文字是否出现在记事本里
5. 再按一次 Win+H 关闭

如果没有弹出来，可能需要在系统设置里开启：
- 打开 Windows 设置（Win+I）
- 搜索「语音」或「Speech」
- 确保「在线语音识别」是开启状态
- 语言设置里确保有中文（简体）语音包

如果你的电脑没有麦克风，需要接一个。笔记本电脑一般自带麦克风，台式机可能需要外接耳麦或者 USB 麦克风。


第六步：运行程序
================================================

1. 打开命令提示符，进入项目文件夹（和第四步一样的 cd 命令）

2. 输入以下命令启动程序：
   python voice_polish.py

3. 如果一切正常，你会看到这样的输出：
   ============================================================
     VoicePolish — 语音输入 + LLM 润色
     快捷键: Ctrl+Alt+V
     按一次开始说话，再按一次自动润色
     按 Ctrl+C 退出
   ============================================================
   [VoicePolish] 快捷键已注册，等待触发...

4. 看到这个界面就说明程序已经在后台运行了。这个黑色窗口不要关，最小化就行。


第七步：开始使用
================================================

程序运行后，你可以在电脑上的任何地方使用它：

1. 按一次 Ctrl+Alt+V（三个键同时按）
   → 会自动弹出一个临时记事本，并打开麦克风
   → 你会看到一个小的语音输入浮窗

2. 对着麦克风说话
   → 你说的话会实时显示在记事本里

3. 说完后，再按一次 Ctrl+Alt+V
   → 程序会自动把记事本里的文字取出来
   → 发送给 AI 进行润色（去掉嗯啊呃等语气词，整理成通顺的句子）
   → 润色后的文字会自动复制到剪贴板
   → 记事本会自动关闭

4. 润色完成后，你可以在任何地方 Ctrl+V 粘贴润色后的文字

5. 想退出程序的时候，回到那个黑色命令窗口，按 Ctrl+C


使用小贴士
================================================

关于语音输入的技巧：
- 说话的时候尽量连贯，不要一个字一个字蹦
- 说完一句话可以稍微停顿一下，语音识别会自动断句
- 如果识别错了不用管，AI 润色的时候会尽量修正
- 环境太吵的话识别效果会变差，尽量在安静的地方用

关于润色效果：
- AI 会去掉「嗯」「呃」「啊」「就是」这类口语化的词
- 会把断断续续的句子整理通顺
- 不会改变你的原意，不会添加你没说过的内容
- 如果是讨论代码或技术话题，专业术语会被保留

关于剪贴板：
- 每次润色完成后，润色结果会留在剪贴板里
- 你可以反复 Ctrl+V 粘贴到不同的地方
- 直到你下一次复制别的东西，剪贴板才会被覆盖

如果遇到「没有检测到语音文字」：
- 这种情况下记事本不会自动关闭
- 你可以手动切到那个记事本窗口，Ctrl+A 全选，Ctrl+C 复制
- 然后自己粘贴到需要的地方
- 下次按 Ctrl+Alt+V 开始新的录音时，旧的记事本会被自动清理


常见问题
================================================

问：运行 python voice_polish.py 报错 ModuleNotFoundError
答：说明依赖没装好。回到第四步，重新运行 pip install -r requirements.txt。如果你电脑上装了多个 Python 版本，试试用 python3 voice_polish.py 或者 py voice_polish.py。

问：按 Ctrl+Alt+V 没反应
答：确认程序还在运行（那个黑色窗口还在）。如果窗口已经关了，重新运行 python voice_polish.py。另外，有些软件可能占用了这个快捷键组合，关掉其他可能冲突的软件试试。

问：语音输入的浮窗弹出来了但是显示「请选择文本框」
答：这是正常的，等一两秒它就会开始识别。如果一直显示这个，试试点一下弹出的记事本窗口再说话。

问：润色结果没有自动粘贴到我的窗口
答：润色结果一定在剪贴板里，你可以手动 Ctrl+V 粘贴。自动粘贴依赖窗口焦点切换，有时候可能切换不过去，但剪贴板里的内容是对的。

问：API 调用失败
答：检查 config.json 里的 api_key 是否正确，api_base 地址是否正确。确认你的网络能访问对应的 API 服务。如果用的是国外的服务（比如 OpenAI），可能需要科学上网。

问：想换一个快捷键
答：用记事本打开 voice_polish.py，搜索 ctrl+alt+v，改成你想要的组合就行，比如 ctrl+alt+p。保存后重新运行程序。


换电脑迁移指南
================================================

如果你换了新电脑，按以下步骤重新部署：

1. 在新电脑上安装 Python（第一步）
2. 把整个 voice_polish 文件夹复制到新电脑上
3. 安装依赖包（第四步）
4. 确认 config.json 里的 API Key 还有效
5. 运行程序（第六步）

就这么简单，总共就一个文件夹的事。config.json 里的 API Key 如果过期了，去对应平台重新生成一个就行。
