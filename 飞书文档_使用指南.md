# VoicePolish 语音输入润色工具

## 这是什么

VoicePolish 是一个 Windows 小工具，让你用语音输入文字，AI 自动帮你把口语化的内容整理成通顺的书面语。

**使用场景举例：**

- 写微信/飞书消息时，不想打字，直接说话
- 写邮件、写文档时，先用语音快速说出想法，AI 帮你整理成书面语
- 回复工作群消息，语音比打字快得多
- 任何需要输入文字的地方，都可以用

**工作流程：** 按快捷键 → 说话 → 再按一次快捷键 → AI 润色 → 自动粘贴到你正在打字的地方。全程不需要手动打一个字。

## 使用效果演示

下面是几个真实的对比示例，左边是语音识别的原始文字，右边是 AI 润色后的结果：

**示例 1：日常沟通**

> **语音原文：** 嗯那个我想说一下就是明天的会议呃可能要推迟一下因为那个会议室被占了然后我们看看能不能换到下午三点
>
> **润色结果：** 明天的会议可能要推迟，因为会议室被占了，我们看看能不能换到下午三点。

**示例 2：技术讨论**

> **语音原文：** 就是那个bug啊我看了一下应该是前端传参数的时候没有做空值判断然后后端收到null就直接报错了
>
> **润色结果：** 那个 bug 我看了一下，应该是前端传参数时没有做空值判断，后端收到 null 就直接报错了。

**示例 3：工作汇报**

> **语音原文：** 额这周的话主要是完成了用户模块的开发然后还有就是修了几个之前遗留的bug嗯下周计划是开始做订单模块
>
> **润色结果：** 这周主要完成了用户模块的开发，还修了几个之前遗留的 bug。下周计划开始做订单模块。

## 环境准备

### 安装 Python

VoicePolish 是用 Python 写的，你的电脑上需要先装 Python。

#### Windows 安装步骤

1. 打开浏览器，访问 Python 官网下载页面：https://www.python.org/downloads/
2. 点页面上最大的那个黄色按钮「Download Python 3.x.x」，下载安装包
3. 双击运行安装包，**注意安装界面最下面的勾选框「Add Python to PATH」—— 一定要勾上！**
4. 勾上之后点「Install Now」，等它装完点 Close 关闭

#### 验证安装是否成功

1. 按键盘上的 `Win` 键，输入 `cmd`，回车打开命令提示符
2. 在黑色窗口里输入：`python --version`
3. 如果显示类似 `Python 3.12.x` 这样的版本号，说明安装成功
4. 如果提示「不是内部或外部命令」，说明安装时没有勾选 Add to PATH，需要卸载重装，记得勾上

### 获取 AI 接口 API Key

这个工具需要调用 AI 接口来润色文字，你需要自己注册一个 API 账号并获取 Key。

#### 豆包（火山引擎）

项目默认使用字节跳动的豆包大模型（Doubao）：

1. 打开火山引擎控制台：https://console.volcengine.com/ark
2. 注册或登录账号
3. 在左侧菜单找到「模型推理」或「API Key 管理」
4. 创建一个 API Key，复制保存好
5. 记下你要用的模型名称（比如 `doubao-seed-1-8-251228`）

#### 其他可选服务

你也可以使用其他兼容 OpenAI 接口格式的 AI 服务，只需要修改 `config.json` 中的 `api_base` 地址：

| 服务商 | api_base 地址 |
|--------|---------------|
| DeepSeek | `https://api.deepseek.com/v1` |
| OpenAI 官方 | `https://api.openai.com/v1` |
| 智谱 AI | `https://open.bigmodel.cn/api/paas/v4` |

不管用哪家，`config.json` 的格式都一样，改三个值就行。

### 确认 Windows 语音输入可用

VoicePolish 依赖 Windows 自带的语音输入功能（`Win+H` 快捷键触发）。

1. 打开记事本，随便点一下让光标在里面
2. 按 `Win+H`（同时按 Windows 键和 H 键）
3. 应该会弹出一个小的麦克风浮窗
4. 对着麦克风说几句话，看文字是否出现在记事本里
5. 再按一次 `Win+H` 关闭

如果没有弹出来，需要在系统设置里开启：

- 打开 Windows 设置（`Win+I`）
- 搜索「语音」或「Speech」
- 确保「在线语音识别」是开启状态
- 语言设置里确保有中文（简体）语音包

如果你的电脑没有麦克风，需要接一个。笔记本一般自带，台式机可能需要外接耳麦或 USB 麦克风。

## 安装与配置

### 下载项目文件

你需要拿到以下文件，放在同一个文件夹里：

```
voice_polish/
  ├── voice_polish.py      （主程序）
  ├── config.json           （API 配置文件）
  └── requirements.txt      （依赖清单）
```

如果是从 GitHub 下载的，点页面上绿色的「Code」按钮，选「Download ZIP」，下载后解压到你想放的位置即可。

### 安装依赖包

#### 常规安装

1. 打开命令提示符（`Win` 键 → 输入 `cmd` → 回车）
2. 用 `cd` 命令进入项目文件夹，比如文件夹在 `D:\voice_polish`：
   ```
   cd /d D:\voice_polish
   ```
3. 运行安装命令：
   ```
   pip install -r requirements.txt
   ```
4. 看到 `Successfully installed` 就说明装好了

如果报错说 pip 不是命令，试试：
```
python -m pip install -r requirements.txt
```

#### 国内镜像加速

如果下载很慢，使用清华镜像源：

```
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### 配置 API 信息

用记事本打开项目文件夹里的 `config.json`（如果是从 GitHub 下载的，先把 `config.example.json` 复制一份并重命名为 `config.json`），改成你自己的信息：

```json
{
  "api_base": "https://ark.cn-beijing.volces.com/api/v3",
  "api_key": "在这里粘贴你自己的API Key",
  "model": "在这里填你要用的模型名称"
}
```

保存关闭即可。

## 使用方法

### 启动程序

1. 打开命令提示符，进入项目文件夹
2. 输入命令启动：
   ```
   python voice_polish.py
   ```
3. 看到以下输出说明启动成功：
   ```
   ============================================================
     VoicePolish — 语音输入 + LLM 润色
     快捷键: Ctrl+Alt+V
     按一次开始说话，再按一次自动润色
     按 Ctrl+C 退出
   ============================================================
   [VoicePolish] 快捷键已注册，等待触发...
   ```
4. 这个黑色窗口不要关，最小化就行

### 操作流程

1. **按一次 `Ctrl+Alt+V`**（三个键同时按）
   - 自动弹出一个临时记事本，并打开麦克风
   - 你会看到一个小的语音输入浮窗

2. **对着麦克风说话**
   - 你说的话会实时显示在记事本里

3. **说完后，再按一次 `Ctrl+Alt+V`**
   - 程序自动取出记事本里的文字
   - 发送给 AI 润色（去掉语气词，整理成通顺的句子）
   - 润色结果自动复制到剪贴板
   - 记事本自动关闭

4. **在任何地方 `Ctrl+V` 粘贴**润色后的文字

5. 想退出程序，回到命令窗口按 `Ctrl+C`

### 使用技巧

#### 语音输入技巧

- 说话尽量连贯，不要一个字一个字蹦
- 说完一句话稍微停顿一下，语音识别会自动断句
- 识别错了不用管，AI 润色时会尽量修正
- 环境太吵识别效果会变差，尽量在安静的地方用

#### 润色效果说明

- AI 会去掉「嗯」「呃」「啊」「就是」这类口语化的词
- 会把断断续续的句子整理通顺
- 不会改变你的原意，不会添加你没说过的内容
- 讨论代码或技术话题时，专业术语会被保留

#### 剪贴板使用

- 每次润色完成后，结果会留在剪贴板里
- 可以反复 `Ctrl+V` 粘贴到不同的地方
- 直到你下一次复制别的东西，剪贴板才会被覆盖

## 常见问题

### 安装类问题

**问：运行 `python voice_polish.py` 报错 `ModuleNotFoundError`**

说明依赖没装好。重新运行 `pip install -r requirements.txt`。如果电脑上装了多个 Python 版本，试试 `python3 voice_polish.py` 或 `py voice_polish.py`。

**问：`pip` 提示不是命令**

试试 `python -m pip install -r requirements.txt`。如果还不行，说明 Python 安装时没有勾选 Add to PATH，需要重装。

### 运行类问题

**问：按 `Ctrl+Alt+V` 没反应**

确认程序还在运行（命令窗口还在）。如果窗口已经关了，重新运行。另外，有些软件可能占用了这个快捷键，关掉可能冲突的软件试试。

**问：润色结果没有自动粘贴到我的窗口**

润色结果一定在剪贴板里，可以手动 `Ctrl+V` 粘贴。自动粘贴依赖窗口焦点切换，有时候可能切换不过去，但剪贴板里的内容是对的。

### 语音识别类问题

**问：语音输入的浮窗弹出来了但是显示「请选择文本框」**

这是正常的，等一两秒就会开始识别。如果一直显示，试试点一下弹出的记事本窗口再说话。

**问：没有检测到语音文字**

这种情况下记事本不会自动关闭。你可以手动切到记事本窗口，`Ctrl+A` 全选，`Ctrl+C` 复制，然后粘贴到需要的地方。下次按快捷键开始新录音时，旧的记事本会被自动清理。

**问：`Win+H` 没有弹出语音输入**

打开 Windows 设置（`Win+I`），搜索「语音」，确保「在线语音识别」已开启，语言设置里有中文（简体）语音包。

### API 类问题

**问：API 调用失败**

检查 `config.json` 里的 `api_key` 是否正确，`api_base` 地址是否正确。确认网络能访问对应的 API 服务。如果用的是国外服务（如 OpenAI），可能需要科学上网。

**问：润色结果质量不好**

可以尝试更换模型。在 `config.json` 中修改 `model` 字段为其他模型名称。不同模型的润色效果可能有差异。

## 进阶设置

### 更换快捷键

用记事本打开 `voice_polish.py`，搜索 `ctrl+alt+v`，改成你想要的组合即可。比如改成 `ctrl+alt+p`：

找到这一行：
```python
kb.add_hotkey("ctrl+alt+v", on_hotkey, suppress=False)
```

改成：
```python
kb.add_hotkey("ctrl+alt+p", on_hotkey, suppress=False)
```

保存后重新运行程序。

### 更换 AI 服务商

只需修改 `config.json` 中的三个字段，无需改代码。以 DeepSeek 为例：

```json
{
  "api_base": "https://api.deepseek.com/v1",
  "api_key": "你的 DeepSeek API Key",
  "model": "deepseek-chat"
}
```

支持所有兼容 OpenAI 接口格式的服务商。

### 自定义润色风格

打开 `voice_polish.py`，找到 `POLISH_PROMPT` 变量，修改提示词即可调整润色风格。

比如想让润色结果更正式：
```
在第 4 条后面加上：6. 使用正式的书面语风格
```

比如想保留更多口语感：
```
把第 1 条改为：1. 只去除明显的语气词（嗯、呃），保留自然的口语表达
```

修改后保存，重新运行程序即可生效。

## 换电脑迁移

如果你换了新电脑，按以下步骤重新部署：

1. 在新电脑上安装 Python（记得勾选 Add to PATH）
2. 把整个 `voice_polish` 文件夹复制到新电脑上
3. 打开命令提示符，进入文件夹，运行 `pip install -r requirements.txt`
4. 确认 `config.json` 里的 API Key 还有效
5. 运行 `python voice_polish.py`

就这么简单，总共就一个文件夹的事。如果 API Key 过期了，去对应平台重新生成一个即可。